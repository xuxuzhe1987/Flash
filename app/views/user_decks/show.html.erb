<h1><%= @user_deck.deck.name %></h1>

 <div class="card-container">
<% @user_deck.deck.cards.each_with_index do |card, i|%>
  <div id="card-<%= i %>" class="card" style="display: none;">
    <p class="question" style="dispaly: block;"><%= card.question %></p><br>
    <hr><br>
    <div class="answer hidden">
      <div><%= card.answer %> </div>
    </div>
    <div class="text-box hidden mb-3">
      <form>
          <input type="text">
          <input type="submit">
      </form>
    </div>
    <div class="hint hidden">
      <div><%= card.hint %> </div>
    </div>
    <div id ="activeCardButtons">
    <button id="flip" type="button" value="Flip" onclick="flip()">Flip</button>
    <!-- need add if statement later, if not exist, then go to create, if exist, then go to update -->
    <button id="next" onclick="nextCard()"><%= link_to "Know", user_cards_path(answer:"xxx", result: true, card_id: card.id, user_id: current_user.id), method: :post %></button>
    <button id="next" onclick="nextCard()"><%= link_to "Unknow", user_cards_path(answer:"xxx", result: false, card_id: card.id, user_id: current_user.id), method: :post %></button>
    <button id="hint" type="button" value="hint" onClick="hint()"> Hint </button>
    <button id="user-answer" type="button" value="Type your Answer" onClick="add()"> Answer Me? </button>
    </div>
      <br>
  </div>
  <% end %>
  </div>



<script type="text/javascript">
  let currentIndex = 0
  let nextIndex = 1
  let cards = document.querySelectorAll(".card")

  let current = document.getElementById(`card-${currentIndex}`)
  current.style.display = "block"

  let next = document.getElementById(`card-${nextIndex}`)

  let questions = document.querySelectorAll(".question")
  let answers = document.querySelectorAll(".answer")
  let hints = document.querySelectorAll(".hint")

  function nextCard() {
    answers.forEach(e => e.classList.add("hidden"))
    questions.forEach(e => e.classList.remove("hidden"))
    current.style.display = "none"
    next.style.display = "block"
    current = next
    currentIndex = currentIndex === (cards.length - 1) ? 0 : currentIndex + 1
    nextIndex = nextIndex === (cards.length - 1) ? 0 : nextIndex + 1
    next = document.getElementById(`card-${nextIndex}`)
  }

  function flip() {
    answers.forEach(e => e.classList.toggle("hidden"))
  }

  function hint() {
    hints.forEach(e => e.classList.toggle("hidden"))
  }

  function add() {

   userAnswers = document.querySelectorAll(".text-box")
   userAnswers.forEach(e => e.classList.toggle("hidden"))

  }
</script>
